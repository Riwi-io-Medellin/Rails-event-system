# Event System

The Event System is a Ruby on Rails application designed to manage events. It allows you to create, store, and retrieve events with attributes such as name, date, and description. Additionally, the system includes features like custom scopes for filtering events by date ranges and callbacks to manage event data more effectively.

This README provides step-by-step instructions to set up the application, configure the necessary gems and environment variables, and use custom scopes and callbacks to enrich the functionality of the app.

# Step 1

Setup Instructions
Follow the steps below to set up and run the Event System on your local machine.

1. Create a New Rails Application
Open your terminal and run the following command to create a new Rails application with PostgreSQL as the database:

```bash
rails new event-system --database=postgresql
```
This will create a new Rails application named event-system and configure it to use PostgreSQL as the database.

2. Add the dotenv Gem
To manage environment variables, we will use the dotenv gem. This will allow us to securely store sensitive information such as database credentials.

Open the Gemfile and add the following line:
ruby
```bash
gem 'dotenv-rails'
```

Run the following command to install the gem:
```bash
bundle install
```

3. Set Up Environment Variables
Create a .env file in the root directory of the project:
```bash
touch .env
```
Add your PostgreSQL database credentials (or any other sensitive information) in the .env file. For example:
```bash
DATABASE_USERNAME=your_db_username
DATABASE_PASSWORD=your_db_password
```


4. Configure Database Settings
Now, update the config/database.yml file to use the environment variables you just added. Replace the database username and password.

5. Create the Database
Run the following command to create the database:

```bash
rake db:create
```

6. Generate the Event Scaffold (model , view, controller)
To generate the Event model, controller, and views, run the following command:

```bash
rails generate scaffold Event name:string date:date description:text
```
This will create all the necessary files for the Event resource, including migration files, model, controller, and views.

7. Run Migrations
Apply the generated migration to create the events table in the database:

```bash
rake db:migrate
```

8. Set the Root Path
To configure the root of the application to display the events page, edit the config/routes.rb file and set the root route as follows:

```bash
root 'events#index'
```

9. Add Custom Scopes in the Model
In the Event model (app/models/event.rb), add custom scopes to filter events based on specific date ranges. For example, to get events created in the last 30 days:

10. Implement Callbacks for Custom Functionality
Add custom callbacks in the Event model to handle specific logic. For example, you can add a before_save callback to adjust the event date before saving the record:

11. Create a Controller Object with Scopes
In the EventsController, create a controller action to use the defined scopes and send the filtered events to the view:

12. Consume the Scopes in the View
In the app/views/events/index.html.erb file, display the filtered events.


# Step 2 Devise Installation

Add an authentication layer with the Devise gem https://rubygems.org/gems/devise
Add the gem to the Gemfile
```bash
  gem 'devise', '~> 4.9', '>= 4.9.4'
```
In the console, install the new gem:
```bash
  bundle install
```
Follow the gem installation configuration:
```bash
  rails generate devise:install
```
The previous command will display the required steps in the console to continue with the gem installation. It should show something like the following:
In config/environments/development.rb, add:
 ```bash
   config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }
```
Specify the model Devise will use. This command will create a new migration to generate a new table for this model:
```bash
   rails generate devise MODEL
```
In the above command, replace MODEL with the model name you want to use, e.g., User.

Go into the migration generated by scaffold and configure any necessary additional fields, like confirmable and lockable.
Create another migration to associate the events and user models:
```bash
  rails generate migration AddUserToEvents user:references
```

Within the reference migration, add something like this:
```bash
   add_reference :events, :user, null: false, foreign_key: true
```

Next, run the migration so that it reflects in the schema:
```bash
  rails db:migrate
```
In the events controller, add a callback to restrict actions. Allow all users to view index and show views, but only allow authenticated users to create, edit, and delete events.
```bash
  before_action :authenticate_user!, except: [:index, :show]
```

Add the necessary logic to store the currently signed-in user as the creator of an event when it is created:

```bash
    @event = current_user.events.build(event_params)
```
